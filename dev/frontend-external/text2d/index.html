<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <style>

            body {
                background-color: #000000;
            }

            .text {
                color: #ffffff;
            }

            .disclaimer {
                color: #ffffff;
                padding-top: 15%;
            }

        </style>
        <title>[ text-2d dev ]</title>
    </head>
    <body>
        <div id="overlay">
            <h1 class="text"></h1>
            <h2 class="disclaimer">[ proof-of-concept ]</h2>

            <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/2.0.2/anime.min.js"></script>
            <script type="text/javascript">
                
                // the following is largely based from https://tobiasahlin.com/moving-letters/#3

                var testThought = "When Europeans kiss cheeks as a greeting, which side do they kiss first? What if they both go the same way? Do they kiss for real?";
                const delayUnit_ms = 50;
                const stopUnit_ms = 1000;

                document.querySelector('.text').innerHTML = testThought;

                // put identifiers onto each letter/punctuation mark
                var textWrapping = document.querySelector('.text');
                //textWrapping.innerHTML = textWrapping.textContent.replace(/[a-zA-Z]/g, "<span class='letter'>$&</span>");
                //textWrapping.innerHTML = textWrapping.textContent.replace(/[.?,!]/g, "<span class='punctuation'>$&</span>");
                textWrapping.innerHTML = textWrapping.textContent.replace(/\S/g, "<span class='letter'>$&</span>");
                
                function generateDelays(text) {
                    let arr = Array();
                    let delay = 0;
                    for (let i = 0; i < text.length; i++) {
                        arr.push(delay);
                        let chr = text.charAt(i);

                        // delay before the next character for longer if the current character is a punctuation mark
                        if (chr == "." || chr == "," || chr == "!" || chr == "?") {
                            delay += delayUnit_ms; //+ stopUnit_ms;
                        }
                        else {
                            delay += delayUnit_ms;
                        }
                    }

                    return arr;
                }
                var delays = generateDelays(testThought);

                anime.timeline({ loop : true })
                    .add({
                        targets : '.text .letter',
                        opacity : [0, 1],
                        easing : "easeInOutQuad",
                        duration : 1000,
                        delay : (el, i) => delays[i],
                    })
                    /*
                    .add({
                        targets : '.text',
                        opacity : 0,
                        duration : 1000,
                        easing : "easeOutExpo",
                        delay : 1000
                    });
                    */
            </script>
        </div>
    </body>
</html>